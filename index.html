<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CashFlow Capitals</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --primary:#6366f1;
  --accent:#8b5cf6;
  --bg:#eef2ff;
  --card:#ffffff;
  --text:#0f172a;
}
body.dark{
  --bg:#020617;
  --card:#0f172a;
  --text:#e5e7eb;
}
body{
  margin:0;
  font-family:Inter,system-ui;
  background:var(--bg);
  color:var(--text);
  transition:.3s;
}
header{
  background:linear-gradient(135deg,var(--primary),var(--accent));
  color:white;
  padding:24px;
  text-align:center;
}
.container{max-width:560px;margin:auto;padding:16px}
.card{
  background:var(--card);
  border-radius:16px;
  padding:16px;
  margin-bottom:16px;
}
h2{
  font-size:18px;
  background:linear-gradient(135deg,var(--primary),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
input,button{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:10px;
  border:2px solid #e5e7eb;
  background:var(--card);
  color:var(--text);
}
button{
  background:linear-gradient(135deg,var(--primary),var(--accent));
  color:white;
  border:none;
  cursor:pointer;
  font-weight:600;
}
.mode{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.mode div{
  padding:12px;
  border-radius:10px;
  border:2px solid #e5e7eb;
  text-align:center;
  cursor:pointer;
}
.mode .active{
  background:linear-gradient(135deg,var(--primary),var(--accent));
  color:white;
  border:none;
}
.hidden{display:none}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  padding:10px;
  border-bottom:1px solid #e5e7eb;
  text-align:left;
}
th{opacity:.7}
.toggle, .reset{
  position:fixed;
  bottom:14px;
  padding:12px 14px;
  border-radius:50%;
}
.toggle{right:14px}
.reset{left:14px;background:#ef4444}
</style>
</head>

<body>

<header>
<h1>ðŸ’° CashFlow Compass</h1>
<p>Competition-Ready Smart Budget Planner</p>
</header>

<button class="toggle" onclick="toggleDark()">ðŸŒ™</button>
<button class="reset" onclick="resetApp()">ðŸ”„</button>

<div class="container">

<div class="card">
<h2>ðŸŽ¯ Select Mode</h2>
<div class="mode">
  <div id="regBtn" onclick="setMode('regular')">Regular Income</div>
  <div id="futBtn" onclick="setMode('future')">Future Planning</div>
</div>
</div>

<!-- REGULAR MODE -->
<div id="regular" class="hidden">
<div class="card">
<h2>ðŸ’µ Monthly Income</h2>
<input id="regIncome" type="number" placeholder="Monthly income â‚¹">
<button onclick="calcRegular()">Calculate</button>
</div>

<div class="card">
<h2>ðŸ“Š Recommendation</h2>
<canvas id="regChart"></canvas>
<table id="regTable"></table>
</div>
</div>

<!-- FUTURE MODE -->
<div id="future" class="hidden">
<div class="card">
<h2>ðŸ“† Future Plan</h2>
<input id="futureMoney" type="number" placeholder="Total money in future â‚¹">
<input id="futureYears" type="number" placeholder="Years">
<input id="goalCost" type="number" placeholder="Goal cost â‚¹">
<button onclick="calcFuture()">Calculate</button>
</div>

<div class="card">
<h2>ðŸ“Š Monthly Recommendation</h2>
<canvas id="futChart"></canvas>
<table id="futTable"></table>
</div>
</div>

</div>

<script>
let state=JSON.parse(localStorage.getItem("cfc"))||{mode:null,dark:false};
function save(){localStorage.setItem("cfc",JSON.stringify(state));}

document.body.classList.toggle("dark",state.dark);
function toggleDark(){
  state.dark=!state.dark;
  document.body.classList.toggle("dark");
  save();
}

function resetApp(){
  if(confirm("Reset all data?")){
    localStorage.removeItem("cfc");
    location.reload();
  }
}

function setMode(m){
  state.mode=m; save();
  regular.classList.toggle("hidden",m!=="regular");
  future.classList.toggle("hidden",m!=="future");
  regBtn.classList.toggle("active",m==="regular");
  futBtn.classList.toggle("active",m==="future");
}
if(state.mode) setMode(state.mode);

let rChart,fChart;

function buildTable(el,data,total){
  el.innerHTML=`
    <tr><th>Category</th><th>â‚¹ / Month</th><th>%</th></tr>`+
    data.map(d=>`
    <tr>
      <td>${d.name}</td>
      <td>â‚¹${Math.round(d.val)}</td>
      <td>${Math.round(d.val/total*100)}%</td>
    </tr>`).join("");
}

/* REGULAR */
function calcRegular(){
  let i=+regIncome.value;
  if(i<=0) return alert("Enter income");

  let d=[
    {name:"Food",val:i*.35},
    {name:"Shopping",val:i*.20},
    {name:"Entertainment",val:i*.15},
    {name:"Savings",val:i*.20},
    {name:"Other",val:i*.10},
  ];

  if(rChart) rChart.destroy();
  rChart=new Chart(regChart,{
    type:"doughnut",
    data:{labels:d.map(x=>x.name),datasets:[{data:d.map(x=>x.val)}]},
    options:{cutout:"65%"}
  });

  buildTable(regTable,d,i);
}

/* FUTURE */
function calcFuture(){
  let total=+futureMoney.value, years=+futureYears.value, cost=+goalCost.value;
  if(total<=0||years<=0||cost<=0) return alert("Fill all fields");

  let m=years*12;
  let monthly=total/m;
  let save=cost/m;
  let spend=monthly-save;
  if(spend<=0) return alert("Goal not feasible");

  let d=[
    {name:"Food",val:spend*.4},
    {name:"Shopping",val:spend*.25},
    {name:"Entertainment",val:spend*.2},
    {name:"Other",val:spend*.15},
  ];

  if(fChart) fChart.destroy();
  fChart=new Chart(futChart,{
    type:"doughnut",
    data:{labels:d.map(x=>x.name),datasets:[{data:d.map(x=>x.val)}]},
    options:{cutout:"65%"}
  });

  buildTable(futTable,d,spend);
}
</script>

</body>
</html>
